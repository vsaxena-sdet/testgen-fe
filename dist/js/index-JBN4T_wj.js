!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const e="http://localhost:8000",t={api:{endpoints:{health:`${e}/healthz`,llmModels:`${e}/llm-models`,upload:`${e}/upload`,generate:`${e}/generate`,testcases:`${e}/testcases`,statistics:`${e}/statistics`,exportExcel:`${e}/export/excel`}}}.api.endpoints,n=e=>document.querySelector(e),o=e=>document.querySelectorAll(e);let s=null,a=!1,r={},l=null;const i={sourceBtns:o(".source-btn"),textSource:n("#textSource"),fileSource:n("#fileSource"),projectName:n("#projectName"),requirementsText:n("#requirementsText"),fileInput:n("#file"),formFactor:n("#formFactor"),testLevelCheckboxes:o('input[name="testLevel"]'),deselectAllBtn:n("#deselectAll"),countSlider:n("#count"),countInput:n("#countInput"),llmModel:n("#llmModel"),advancedToggle:n("#advancedToggle"),advancedOptions:n("#advancedOptions"),toggleIcon:n(".toggle-icon"),form:n("#testGenForm"),generateBtn:n("#btnGenerate"),exportBtn:n("#btnExport"),exportMenu:n("#exportMenu"),exportJson:n("#exportJson"),exportExcel:n("#exportExcel"),latestBtn:n("#btnLatest"),uploadStatus:n("#uploadStatus"),docIdDisplay:n("#docIdDisplay"),docIdGroup:n("#docIdGroup"),docIdInput:n("#docId"),genStatus:n("#genStatus"),resultsSection:n("#resultsSection"),latest:n("#latest"),statsSection:n("#statsSection"),totalCases:n("#totalCases"),highPriority:n("#highPriority"),mediumPriority:n("#mediumPriority"),lowPriority:n("#lowPriority")};async function c(e){const o=e.target.files;if(!o||0===o.length)return void d("Please select a file.","error");const a=o[0],r=a.name.toLowerCase();if(![".txt",".md",".doc",".docx",".pdf"].some(e=>r.endsWith(e.replace(".",""))))return void d("Please upload a valid file type (.txt, .md, .doc, .docx, .pdf)","error");if(a.size>10485760)d("File size must be less than 10MB","error");else try{d("Uploading file...","loading");const e=new FormData;e.append("file",a);const o=await fetch(t.upload,{method:"POST",body:e}),r=await o.json();o.ok?(s=r.doc_id,i.docIdDisplay&&(i.docIdDisplay.innerHTML=`<strong>Doc ID:</strong> ${s}`,i.docIdDisplay.classList.remove("hidden")),i.docIdInput&&(i.docIdInput.value=s),d("File uploaded successfully! Uploading to Open AI Vector Store in background...","success"),function(e){n(".file-upload-placeholder").innerHTML=`\n    <div class="upload-icon">‚úÖ</div>\n    <div class="upload-text">\n      <span class="upload-primary">${e}</span>\n      <span class="upload-secondary">File uploaded successfully</span>\n    </div>\n  `}(a.name)):d(`Upload failed: ${r.detail||o.statusText}`,"error")}catch(l){d(`Upload failed: ${l.message}`,"error")}}function d(e,t){i.uploadStatus.textContent=e,i.uploadStatus.className=`upload-status ${t}`}function u(e,t){i.genStatus.textContent=e,i.genStatus.className=`generation-status ${t}`}async function p(e){if(e.preventDefault(),!a&&function(){if(!l||!i.llmModel.value)return u("‚ùå Please select an AI model.","error"),i.llmModel.focus(),!1;const e=i.requirementsText.value.trim(),t=i.fileInput.files.length>0,n=!i.textSource.classList.contains("hidden");if(n&&!e)return u("‚ùå Please enter your requirements text.","error"),i.requirementsText.focus(),!1;if(!n&&!t)return u("‚ùå Please upload a requirements file.","error"),!1;if(0===Array.from(i.testLevelCheckboxes).filter(e=>e.checked).length)return u("‚ùå Please select at least one test level.","error"),!1;return!0}()){a=!0,f(!0);try{const e=function(){var e,t,n;const o=!i.textSource.classList.contains("hidden"),s=Array.from(i.testLevelCheckboxes).filter(e=>e.checked).map(e=>e.value),a={project_name:i.projectName.value.trim(),requirements_text:o?i.requirementsText.value.trim():null,doc_id:(null==(e=i.docIdInput)?void 0:e.value.trim())||null,form_factor:i.formFactor.value,test_levels:s,count:parseInt((null==(t=i.countInput)?void 0:t.value)||(null==(n=i.countSlider)?void 0:n.value))||100,top_k:12,modes:[i.formFactor.value],llm_model:l.id,llm_provider:l.provider};return a}();u("ü§ñ Generating test cases... This may take a moment.","loading");const n=await fetch(t.generate,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),o=await n.json();n.ok?(u(`‚úÖ Successfully generated ${o.count} test cases!`,"success"),function(e){i.resultsSection.classList.remove("hidden"),i.latest.textContent=JSON.stringify(e,null,2),h(),i.resultsSection.scrollIntoView({behavior:"smooth"})}(o)):u(`‚ùå Generation failed: ${o.detail||n.statusText}`,"error")}catch(n){u(`‚ùå Generation failed: ${n.message}`,"error")}finally{a=!1,f(!1)}}}function f(e){e?(i.generateBtn.disabled=!0,i.generateBtn.innerHTML='\n      <span class="btn-icon loading">‚è≥</span>\n      Generating...\n    '):(i.generateBtn.disabled=!1,i.generateBtn.innerHTML='\n      <span class="btn-icon">‚ö°</span>\n      Generate Test Cases\n    ')}async function m(){try{const e=await fetch(t.testcases),n=await e.json();e.ok?(i.latest.textContent=JSON.stringify(n,null,2),i.resultsSection.classList.remove("hidden"),h()):alert("Failed to fetch latest results: "+(n.detail||e.statusText))}catch(e){alert("Error fetching results: "+e.message)}}function v(){const e=i.latest.textContent;if(e)try{const t=JSON.parse(e),n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),o=URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download=`test-cases-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o),i.exportBtn.parentElement.classList.remove("open"),i.exportMenu.classList.add("hidden")}catch(t){alert("Error exporting results: "+t.message)}else alert("No results to export. Please generate test cases first.")}async function g(){try{u("üìä Generating Excel file...","loading");const e=await fetch(t.exportExcel);if(e.ok){const t=e.headers.get("content-disposition");let n="test-cases.xlsx";if(t){const e=t.match(/filename="?([^"]+)"?/);e&&(n=e[1])}const o=await e.blob(),s=URL.createObjectURL(o),a=document.createElement("a");a.href=s,a.download=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),u("‚úÖ Excel file downloaded successfully!","success")}else{u(`‚ùå Export failed: ${(await e.json()).detail||e.statusText}`,"error")}}catch(e){u(`‚ùå Export failed: ${e.message}`,"error")}finally{i.exportBtn.parentElement.classList.remove("open"),i.exportMenu.classList.add("hidden")}}async function h(){try{const e=await fetch(t.statistics);if(e.ok){const t=await e.json();i.totalCases&&(i.totalCases.textContent=t.total_cases),i.highPriority&&(i.highPriority.textContent=t.high_priority),i.mediumPriority&&(i.mediumPriority.textContent=t.medium_priority),i.lowPriority&&(i.lowPriority.textContent=t.low_priority),i.statsSection&&t.total_cases>0&&i.statsSection.classList.remove("hidden")}}catch(e){console.error("Failed to update statistics:",e)}}function L(){i.llmModel.innerHTML='\n    <option value="">Select an AI model...</option>\n    <optgroup label="OpenAI">\n      <option value="gpt-4o" data-provider="openai">GPT-4o (Latest)</option>\n      <option value="gpt-4" data-provider="openai">GPT-4</option>\n      <option value="gpt-3.5-turbo" data-provider="openai">GPT-3.5 Turbo</option>\n    </optgroup>\n    <optgroup label="LLAMA3">\n      <option value="llama3" data-provider="llama3">LLAMA3 8B</option>\n    </optgroup>\n  '}function x(){const e=i.llmModel.selectedOptions[0];if(!e||!e.value)return;const t=e.value,o=e.getAttribute("data-provider"),s=e.getAttribute("data-description");l={id:t,provider:o,description:s},function(e){const t=n(".model-info");t&&t.remove();if(e){const t=document.createElement("div");t.className="model-info",t.textContent=`‚ÑπÔ∏è ${e}`,i.llmModel.parentNode.appendChild(t)}}(s)}document.addEventListener("DOMContentLoaded",function(){i.sourceBtns.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.source;i.sourceBtns.forEach(e=>e.classList.remove("active")),e.classList.add("active"),"text"===t?(i.textSource.classList.remove("hidden"),i.fileSource.classList.add("hidden")):(i.textSource.classList.add("hidden"),i.fileSource.classList.remove("hidden"))})}),function(){i.deselectAllBtn&&i.deselectAllBtn.addEventListener("click",()=>{const e=Array.from(i.testLevelCheckboxes).every(e=>e.checked);i.testLevelCheckboxes.forEach(t=>{t.checked=!e}),i.deselectAllBtn.textContent=e?"Select All":"Deselect All"});i.testLevelCheckboxes.forEach(e=>{e.addEventListener("change",()=>{const e=Array.from(i.testLevelCheckboxes).every(e=>e.checked);i.deselectAllBtn&&(i.deselectAllBtn.textContent=e?"Deselect All":"Select All")})})}(),i.advancedToggle.addEventListener("click",()=>{i.advancedOptions.classList.contains("hidden")?(i.advancedOptions.classList.remove("hidden"),i.toggleIcon.classList.add("rotated")):(i.advancedOptions.classList.add("hidden"),i.toggleIcon.classList.remove("rotated"))}),i.fileInput.addEventListener("change",c),i.form.addEventListener("submit",p),i.latestBtn&&i.latestBtn.addEventListener("click",m),function(){const e=n(".file-upload-area");function t(e){e.preventDefault(),e.stopPropagation()}function o(t){e.classList.add("drag-over")}function s(t){e.classList.remove("drag-over")}function a(e){const t=e.dataTransfer.files;i.fileInput.files=t,c({target:{files:t}})}["dragenter","dragover","dragleave","drop"].forEach(n=>{e.addEventListener(n,t,!1),document.body.addEventListener(n,t,!1)}),["dragenter","dragover"].forEach(t=>{e.addEventListener(t,o,!1)}),["dragleave","drop"].forEach(t=>{e.addEventListener(t,s,!1)}),e.addEventListener("drop",a,!1)}(),i.exportBtn&&i.exportMenu&&(i.exportBtn.addEventListener("click",e=>{e.stopPropagation();const t=i.exportBtn.parentElement,n=t.classList.contains("open");document.querySelectorAll(".export-dropdown.open").forEach(e=>{e.classList.remove("open"),e.querySelector(".export-menu").classList.add("hidden")}),n||(t.classList.add("open"),i.exportMenu.classList.remove("hidden"))}),i.exportJson&&i.exportJson.addEventListener("click",v),i.exportExcel&&i.exportExcel.addEventListener("click",g),document.addEventListener("click",e=>{var t,n;const o=null==(t=i.exportBtn)?void 0:t.parentElement;o&&!o.contains(e.target)&&(o.classList.remove("open"),null==(n=i.exportMenu)||n.classList.add("hidden"))})),function(){if(i.countSlider&&i.countInput){const e=e=>{const t=parseInt(i.countSlider.min),n=(e-t)/(parseInt(i.countSlider.max)-t)*100;i.countSlider.style.background=`linear-gradient(to right, #ffffff 0%, #ffffff ${n}%, #334155 ${n}%, #334155 100%)`};e(i.countSlider.value),i.countSlider.addEventListener("input",t=>{const n=t.target.value;i.countInput.value=n,e(n)}),i.countInput.addEventListener("input",t=>{let n=parseInt(t.target.value);""!==t.target.value&&(isNaN(n)||(n<20&&(n=20),n>200&&(n=200),n=20*Math.round(n/20),i.countInput.value=n,i.countSlider.value=n,e(n)))}),i.countInput.addEventListener("blur",t=>{(""===t.target.value||isNaN(parseInt(t.target.value)))&&(i.countInput.value=100,i.countSlider.value=100,e(100))})}}(),async function(){try{const e=await fetch(t.llmModels);e.ok?(r=await e.json(),function(){const e=i.llmModel;e.innerHTML='<option value="">Select an AI model...</option>',Object.entries(r).forEach(([t,n])=>{const o=document.createElement("optgroup");o.label=n.name,n.models.forEach(e=>{const n=document.createElement("option");n.value=e.id,n.textContent=e.name,n.setAttribute("data-provider",t),n.setAttribute("data-description",e.description),o.appendChild(n)}),e.appendChild(o)})}()):(console.error("Failed to load LLM models"),L())}catch(e){console.error("Error loading LLM models:",e),L()}}(),i.llmModel&&i.llmModel.addEventListener("change",x)});
