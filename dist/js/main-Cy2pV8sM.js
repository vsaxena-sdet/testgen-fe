import{c as e}from"./config-3a6Bf74B.js";const t=e.api.endpoints,n=e=>document.querySelector(e),o=e=>document.querySelectorAll(e),a=crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let s=null,r=!1,l={},i=null;const c={sourceBtns:o(".source-btn"),textSource:n("#textSource"),fileSource:n("#fileSource"),projectName:n("#projectName"),requirementsText:n("#requirementsText"),fileInput:n("#file"),formFactor:n("#formFactor"),testLevelCheckboxes:o('input[name="testLevel"]'),deselectAllBtn:n("#deselectAll"),countSlider:n("#count"),countInput:n("#countInput"),llmModel:n("#llmModel"),advancedToggle:n("#advancedToggle"),advancedOptions:n("#advancedOptions"),toggleIcon:n(".toggle-icon"),form:n("#testGenForm"),generateBtn:n("#btnGenerate"),exportBtn:n("#btnExport"),exportMenu:n("#exportMenu"),exportJson:n("#exportJson"),exportExcel:n("#exportExcel"),latestBtn:n("#btnLatest"),uploadStatus:n("#uploadStatus"),docIdDisplay:n("#docIdDisplay"),docIdGroup:n("#docIdGroup"),docIdInput:n("#docId"),genStatus:n("#genStatus"),resultsSection:n("#resultsSection"),latest:n("#latest"),statsSection:n("#statsSection"),totalCases:n("#totalCases"),highPriority:n("#highPriority"),mediumPriority:n("#mediumPriority"),lowPriority:n("#lowPriority")};async function d(e){const o=e.target.files;if(!o||0===o.length)return void u("Please select a file.","error");const r=o[0],l=r.name.toLowerCase();if(![".txt",".md",".doc",".docx",".pdf"].some(e=>l.endsWith(e.replace(".",""))))return void u("Please upload a valid file type (.txt, .md, .doc, .docx, .pdf)","error");if(r.size>10485760)u("File size must be less than 10MB","error");else try{u("Uploading file...","loading");const e=new FormData;e.append("file",r);const o=await fetch(t.upload,{method:"POST",headers:{"X-Session-ID":a},body:e}),l=await o.json();o.ok?(s=l.doc_id,c.docIdDisplay&&(c.docIdDisplay.innerHTML=`<strong>Doc ID:</strong> ${s}`,c.docIdDisplay.classList.remove("hidden")),c.docIdInput&&(c.docIdInput.value=s),u("File uploaded successfully! Uploading to Open AI Vector Store in background...","success"),function(e){n(".file-upload-placeholder").innerHTML=`\n    <div class="upload-icon">‚úÖ</div>\n    <div class="upload-text">\n      <span class="upload-primary">${e}</span>\n      <span class="upload-secondary">File uploaded successfully</span>\n    </div>\n  `}(r.name)):u(`Upload failed: ${l.detail||o.statusText}`,"error")}catch(i){u(`Upload failed: ${i.message}`,"error")}}function u(e,t){c.uploadStatus.textContent=e,c.uploadStatus.className=`upload-status ${t}`}function p(e,t){c.genStatus.textContent=e,c.genStatus.className=`generation-status ${t}`}async function m(e){if(e.preventDefault(),!r&&function(){if(!i||!c.llmModel.value)return p("‚ùå Please select an AI model.","error"),c.llmModel.focus(),!1;const e=c.requirementsText.value.trim(),t=c.fileInput.files.length>0,n=!c.textSource.classList.contains("hidden");if(n&&!e)return p("‚ùå Please enter your requirements text.","error"),c.requirementsText.focus(),!1;if(!n&&!t)return p("‚ùå Please upload a requirements file.","error"),!1;if(0===Array.from(c.testLevelCheckboxes).filter(e=>e.checked).length)return p("‚ùå Please select at least one test level.","error"),!1;return!0}()){r=!0,f(!0);try{const e=function(){var e,t,n;const o=!c.textSource.classList.contains("hidden"),a=Array.from(c.testLevelCheckboxes).filter(e=>e.checked).map(e=>e.value),s={project_name:c.projectName.value.trim(),requirements_text:o?c.requirementsText.value.trim():null,doc_id:(null==(e=c.docIdInput)?void 0:e.value.trim())||null,form_factor:c.formFactor.value,test_levels:a,count:parseInt((null==(t=c.countInput)?void 0:t.value)||(null==(n=c.countSlider)?void 0:n.value))||100,top_k:12,modes:[c.formFactor.value],llm_model:i.id,llm_provider:i.provider};return s}();p("ü§ñ Generating test cases... This may take a moment.","loading");const n=await fetch(t.generate,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":a},body:JSON.stringify(e)}),o=await n.json();n.ok?(p(`‚úÖ Successfully generated ${o.count} test cases!`,"success"),function(e){c.resultsSection.classList.remove("hidden"),c.latest.textContent=JSON.stringify(e,null,2),L(),c.resultsSection.scrollIntoView({behavior:"smooth"})}(o)):p(`‚ùå Generation failed: ${o.detail||n.statusText}`,"error")}catch(n){p(`‚ùå Generation failed: ${n.message}`,"error")}finally{r=!1,f(!1)}}}function f(e){e?(c.generateBtn.disabled=!0,c.generateBtn.innerHTML='\n      <span class="btn-icon loading">‚è≥</span>\n      Generating...\n    '):(c.generateBtn.disabled=!1,c.generateBtn.innerHTML='\n      <span class="btn-icon">‚ö°</span>\n      Generate Test Cases\n    ')}async function v(){try{const e=await fetch(t.testcases,{headers:{"X-Session-ID":a}}),n=await e.json();e.ok?(c.latest.textContent=JSON.stringify(n,null,2),c.resultsSection.classList.remove("hidden"),L()):alert("Failed to fetch latest results: "+(n.detail||e.statusText))}catch(e){alert("Error fetching results: "+e.message)}}function h(){const e=c.latest.textContent;if(e)try{const t=JSON.parse(e),n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),o=URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download=`test-cases-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o),c.exportBtn.parentElement.classList.remove("open"),c.exportMenu.classList.add("hidden")}catch(t){alert("Error exporting results: "+t.message)}else alert("No results to export. Please generate test cases first.")}async function g(){try{p("üìä Generating Excel file...","loading");const e=await fetch(t.exportExcel,{headers:{"X-Session-ID":a}});if(e.ok){const t=e.headers.get("content-disposition");let n="test-cases.xlsx";if(t){const e=t.match(/filename="?([^"]+)"?/);e&&(n=e[1])}const o=await e.blob(),a=URL.createObjectURL(o),s=document.createElement("a");s.href=a,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a),p("‚úÖ Excel file downloaded successfully!","success")}else{p(`‚ùå Export failed: ${(await e.json()).detail||e.statusText}`,"error")}}catch(e){p(`‚ùå Export failed: ${e.message}`,"error")}finally{c.exportBtn.parentElement.classList.remove("open"),c.exportMenu.classList.add("hidden")}}async function L(){try{const e=await fetch(t.statistics,{headers:{"X-Session-ID":a}});if(e.ok){const t=await e.json();c.totalCases&&(c.totalCases.textContent=t.total_cases),c.highPriority&&(c.highPriority.textContent=t.high_priority),c.mediumPriority&&(c.mediumPriority.textContent=t.medium_priority),c.lowPriority&&(c.lowPriority.textContent=t.low_priority),c.statsSection&&t.total_cases>0&&c.statsSection.classList.remove("hidden")}}catch(e){console.error("Failed to update statistics:",e)}}function x(){c.llmModel.innerHTML='\n    <option value="">Select an AI model...</option>\n    <optgroup label="OpenAI">\n      <option value="gpt-4o" data-provider="openai">GPT-4o (Latest)</option>\n      <option value="gpt-4" data-provider="openai">GPT-4</option>\n      <option value="gpt-3.5-turbo" data-provider="openai">GPT-3.5 Turbo</option>\n    </optgroup>\n    <optgroup label="LLAMA3">\n      <option value="llama3" data-provider="llama3">LLAMA3 8B</option>\n    </optgroup>\n  '}function y(){const e=c.llmModel.selectedOptions[0];if(!e||!e.value)return;const t=e.value,o=e.getAttribute("data-provider"),a=e.getAttribute("data-description");i={id:t,provider:o,description:a},function(e){const t=n(".model-info");t&&t.remove();if(e){const t=document.createElement("div");t.className="model-info",t.textContent=`‚ÑπÔ∏è ${e}`,c.llmModel.parentNode.appendChild(t)}}(a)}document.addEventListener("DOMContentLoaded",function(){c.sourceBtns.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.source;c.sourceBtns.forEach(e=>e.classList.remove("active")),e.classList.add("active"),"text"===t?(c.textSource.classList.remove("hidden"),c.fileSource.classList.add("hidden")):(c.textSource.classList.add("hidden"),c.fileSource.classList.remove("hidden"))})}),function(){c.deselectAllBtn&&c.deselectAllBtn.addEventListener("click",()=>{const e=Array.from(c.testLevelCheckboxes).every(e=>e.checked);c.testLevelCheckboxes.forEach(t=>{t.checked=!e}),c.deselectAllBtn.textContent=e?"Select All":"Deselect All"});c.testLevelCheckboxes.forEach(e=>{e.addEventListener("change",()=>{const e=Array.from(c.testLevelCheckboxes).every(e=>e.checked);c.deselectAllBtn&&(c.deselectAllBtn.textContent=e?"Deselect All":"Select All")})})}(),c.advancedToggle.addEventListener("click",()=>{c.advancedOptions.classList.contains("hidden")?(c.advancedOptions.classList.remove("hidden"),c.toggleIcon.classList.add("rotated")):(c.advancedOptions.classList.add("hidden"),c.toggleIcon.classList.remove("rotated"))}),c.fileInput.addEventListener("change",d),c.form.addEventListener("submit",m),c.latestBtn&&c.latestBtn.addEventListener("click",v),function(){const e=n(".file-upload-area");function t(e){e.preventDefault(),e.stopPropagation()}function o(t){e.classList.add("drag-over")}function a(t){e.classList.remove("drag-over")}function s(e){const t=e.dataTransfer.files;c.fileInput.files=t,d({target:{files:t}})}["dragenter","dragover","dragleave","drop"].forEach(n=>{e.addEventListener(n,t,!1),document.body.addEventListener(n,t,!1)}),["dragenter","dragover"].forEach(t=>{e.addEventListener(t,o,!1)}),["dragleave","drop"].forEach(t=>{e.addEventListener(t,a,!1)}),e.addEventListener("drop",s,!1)}(),c.exportBtn&&c.exportMenu&&(c.exportBtn.addEventListener("click",e=>{e.stopPropagation();const t=c.exportBtn.parentElement,n=t.classList.contains("open");document.querySelectorAll(".export-dropdown.open").forEach(e=>{e.classList.remove("open"),e.querySelector(".export-menu").classList.add("hidden")}),n||(t.classList.add("open"),c.exportMenu.classList.remove("hidden"))}),c.exportJson&&c.exportJson.addEventListener("click",h),c.exportExcel&&c.exportExcel.addEventListener("click",g),document.addEventListener("click",e=>{var t,n;const o=null==(t=c.exportBtn)?void 0:t.parentElement;o&&!o.contains(e.target)&&(o.classList.remove("open"),null==(n=c.exportMenu)||n.classList.add("hidden"))})),function(){if(c.countSlider&&c.countInput){const e=e=>{const t=parseInt(c.countSlider.min),n=(e-t)/(parseInt(c.countSlider.max)-t)*100;c.countSlider.style.background=`linear-gradient(to right, #ffffff 0%, #ffffff ${n}%, #334155 ${n}%, #334155 100%)`};e(c.countSlider.value),c.countSlider.addEventListener("input",t=>{const n=t.target.value;c.countInput.value=n,e(n)}),c.countInput.addEventListener("input",t=>{let n=parseInt(t.target.value);""!==t.target.value&&(isNaN(n)||(n<20&&(n=20),n>200&&(n=200),n=20*Math.round(n/20),c.countInput.value=n,c.countSlider.value=n,e(n)))}),c.countInput.addEventListener("blur",t=>{(""===t.target.value||isNaN(parseInt(t.target.value)))&&(c.countInput.value=100,c.countSlider.value=100,e(100))})}}(),async function(){try{const e=await fetch(t.llmModels,{headers:{"X-Session-ID":a}});e.ok?(l=await e.json(),function(){const e=c.llmModel;e.innerHTML='<option value="">Select an AI model...</option>',Object.entries(l).forEach(([t,n])=>{const o=document.createElement("optgroup");o.label=n.name,n.models.forEach(e=>{const n=document.createElement("option");n.value=e.id,n.textContent=e.name,n.setAttribute("data-provider",t),n.setAttribute("data-description",e.description),o.appendChild(n)}),e.appendChild(o)})}()):(console.error("Failed to load LLM models"),x())}catch(e){console.error("Error loading LLM models:",e),x()}}(),c.llmModel&&c.llmModel.addEventListener("change",y)});
